---
output: github_document
bibliography: simbib.bib
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# Reproduce the Analysis from @gerard2021double

This repo contains the scripts and instructions to reproduce the results of @gerard2021double. This involves simulations and real data analyses using the data from @shirasawa2017high and @delomas2020inference.

## Instructions

To run these scripts, you will need to have the latest version of R, GNU Make, wget, and 7-zip, running on a Linux system.

1. Download the data from @delomas2020inference from Dryad [XYZ DOI goes here] and place it in "./data/sturg/knowPloidySturgeon_for_DG.txt".

2. Install the appropriate R packages

    ```{r, eval = FALSE}
    install.packages(c("devtools",
                       "tidyverse",
                       "ggthemes",
                       "latex2exp",
                       "BiocManager",
                       "future"))
    BiocManager::install("VariantAnnotation")
    devtools::install_github("dcgerard/hwep")
    devtools::install_github("dcgerard/phwelike")
    devtools::install_github("dcgerard/updog")
    ```
    
    The hwep package contains the new methods from @gerard2021double, while the phwelike package contains the code written by @jiang2021computational and placed in package form by me.

3. Run `make` in the terminal.

## Other Files

- [alpha_tetra.nb](./analysis/alpha_tetra.nb) is a Mathematica
  notebook that solves for the double reduction parameter given the
  gamete genotype frequencies in a tetraploid population at HWE. 
  This file was used to derive Equation (XYZ) in @gerard2021double.
  The segregation probabilities come from Table 9 of @fisher1943inheritance.
- [diploid.nb](./analysis/diploid.nb) is a Mathematica notebook that
  explores the $U$-statistic approach to testing for equilibrium in 
  diploids.
- [hex_equi.nb](./analysis/hex_equi.nb) is a Mathematica notebook that
  calculates gamete frequencies at equilibrium for hexaploids.
  
## Session Information

```{r, echo = FALSE, message=FALSE, warning=FALSE, results='hide'}
lapply(c("devtools",
         "tidyverse",
         "ggthemes",
         "latex2exp",
         "hwep",
         "phwelike",
         "BiocManager",
         "VariantAnnotation",
         "future",
         "updog"), 
       FUN = library,
       character.only = TRUE)
```

```{r, echo = FALSE, comment=""}
sessionInfo()
```

# References
